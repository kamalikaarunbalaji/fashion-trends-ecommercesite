<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Add to cart page</title>
  <link rel="stylesheet" href="css/style.css">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
</head>

<body style="background-color:rgb(222, 157, 167);">

  <script src="external.js"></script>

  <!-- Navbar -->
  <nav class="navbar" style="background-color:rgb(199, 199, 219);">
    <div class="container-fluid">
      <div class="navbar">
        <h2><i class="fas fa-shopping-bag m-3" style="color:chocolate"></i>Fashion Trends</h2>
      </div>
      <div class="navbar d-flex">
        <a href="home.html" style="text-decoration: none;">Home</a>
        <a href="cart.html" style="text-decoration: none;" class="icon-badge">Cart</a></li>
        <a href="wishlist.html" style="text-decoration: none;" class="icon-badge">Wishlist</a></li>
        <span class="icon-badge" id="carticon">
          <i class="fas fa-shopping-cart" style="font-size:30px;color:rgb(3, 90, 118)"></i>
          <span class="badge bg-primary" id="cart-badge">0</span>
        </span>
        <span class="icon-badge" id="wishlisticon">
          <i class="fa fa-heart" style="font-size:25px;color:red"></i>
          <span class="badge bg-danger" id="wishlist-badge">0</span>
        </span>
      </div>
    </div>
  </nav>

  <div id="cart-products"></div>
  <div class="container mt-5">
    <h1 class="text-center mb-4">Your cart</h1>
    <table class="table table-bordered" id="cart-table">
        <tr>
          <th>Image</th>
          <th>Product Name</th>
          <th>Quantity</th>
          <th>Price (₹)</th>
          <th>Total (₹)</th>
        </tr>
      <tbody id="cart-body">
      </tbody>
    </table>
  </div>

  <div class="d-flex justify-content-end align-items-center my-4 me-4">
    <div class="text-end">
      <p><strong>Total: ₹<span id="total-cart-amount">0</span></strong></p>
      <button class="btn btn-success" onclick="payNow()">Pay Now</button>
    </div>
  </div>


  <!-- footer -->

  <div class="footer-container">
    <div class="footer-content">
      <i class="fa-solid fa-location-dot"></i>
      <p>21 Revolution Street Paris,France</p>
      <i class="fa-solid fa-phone"></i>
      <p>+1 555 123456</p>
      <i class="fa-solid fa-envelope"></i>
      <p>support@company.com</p>
    </div>
    <div class="foot">
      <h1>About the company</h1>
      <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit.
        Dignissimos enim adipisci eveniet, earum fugiatsoluta eos vel possimus eius illum libero natus sit voluptate ad
        vitae doloribus ullam numquam molestiae.</p>
      <i class="fa-brands fa-facebook"></i>
      <i class="fa-brands fa-twitter"></i>
      <i class="fa-brands fa-linkedin"></i>
      <i class="fa-brands fa-github"></i>
    </div>
  </div>

  <script>
    // localStorage.clear();
    function renderCartTable() {
      const cartBody = document.getElementById("cart-body");
      const cartData = JSON.parse(localStorage.getItem("cart") || "{}");
      cartBody.innerHTML = "";

      let total = 0;

      const cartKeys = Object.keys(cartData);
      if (cartKeys.length === 0) {
        cartBody.innerHTML = `<tr><td colspan="6" class="text-center">Your cart is empty.</td></tr>`;
        document.getElementById("total-cart-amount").innerText = "0";
        return;
      }

      cartKeys.forEach(id => {
        const item = cartData[id];
        const itemTotal = item.price * item.qty;
        total += itemTotal;

        cartBody.innerHTML += `
      <tr style="text-align:center;">
        <td><img src="${item.image}" width="60" height="60" alt="${item.name}"></td>
        <td>${item.name}</td>
         <td>${item.qty}</td>
        <td>₹${item.price}</td>
        <td>₹${itemTotal}</td>
      </tr>
    `;
      });
      document.getElementById("total-cart-amount").innerText = total;
    }

    function payNow() {
      const cartData = JSON.parse(localStorage.getItem("cart") || "{}");

      if (Object.keys(cartData).length === 0) {
        alert("Your cart is empty.");
        return;
      }

      alert("Payment successful! Thank you.");


      const paidItems = JSON.parse(localStorage.getItem("paidProducts") || "[]");
      const updatedPaidItems = paidItems.concat(Object.values(cartData));
      localStorage.setItem("paidProducts", JSON.stringify(updatedPaidItems));

      localStorage.removeItem("cart");
      localStorage.setItem("totalAddClicks", "0");

      document.getElementById("cart-badge").innerText = "0";


      renderCartTable();
      document.getElementById("total-cart-amount").innerText = "0";
    }
    window.onload = function () {
      renderCartTable();
      updateCartBadge();


      document.getElementById("carticon").addEventListener("click", () => {
        window.location.href = "cart.html";
      });
      document.getElementById("wishlisticon").addEventListener("click", () => {
        window.location.href = "wishlist.html";
      });
    };

    function updateCartBadge() {
      const cart = JSON.parse(localStorage.getItem("cart") || "{}");
      let totalQty = 0;
      Object.values(cart).forEach(item => {
        totalQty += item.qty;
      });
      document.getElementById("cart-badge").innerText = totalQty || 0;
    }

  </script>
</body>

</html>